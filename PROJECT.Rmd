---
title: " DATA PROJECT"
author: "Angelica Gamboa and Gwendolyn Espinoza"
date: "2025-03-28"
output:
  slidy_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# INTRODUCTION
The data we gathered comes from the National Center for Health Statistics (NCHS), specifically the Leading Causes of Death in the United States dataset and reported crime incidents from the City of Chicago.The NCHS dataset provided us with information on the mortality statistics across various states throughout the years with the exception of murder. 

To protect the privacy of the victims, the specific locations of the incidents are not identified, but rather addresses are shown at the block level. Several variables are included in this data such as Year, X113 cause name, cause name, state, deaths, and age adjusted death rate. 

---


# QUESTIONS
1. What are the leading causes of death since 2001?
2. Which state had the most amount of deaths in the US?
3. What was the leading cause of death in California?
4. How has the cause of heart disease deaths changed over time?
5. How has the cause of cancer deaths changed over time?


# Unfiltered Data

```{r}
library(tidyverse)
library(dplyr)
data <- read.csv("NCHS_-_Leading_Causes_of_Death__United_States (1).csv")
glimpse(data)
```

# Data Key Terms

**Year**: Year in which the incident took place.                   
**X113.Cause.Name**: The full, official name of the cause of death classified by the NCHS.         
**Cause.Name**: A broader label for the cause of death.               
**State**: The U.S. state where the data was collected.                  
**Deaths**: The total number of deaths reported for a specific cause of death.
**Age.adjusted.Death.Rate**: The death rate per 100,000 people, adjusted per age group for fair comparison. 

---

## **Leading Causes of Death Since 2001**
```{r}
# Filtering the data and removing "United States" from the column named 'States'
top_causes <- data %>%
  filter(Cause.Name != "All causes", State != "United States") %>% 
  group_by(Cause.Name) %>%
  summarise(total_deaths = sum(Deaths)) %>%
  arrange(desc(total_deaths))
  
# Plotting causes of death
ggplot(top_causes, aes(x = total_deaths, y = reorder(Cause.Name, total_deaths))) +
  geom_col(fill = 'purple3') +
  labs(title = 'Top 10 Causes of Death in the U.S. Since 2001',
       x = 'Total Deaths',
       y = 'Cause of Death')
```

---

## **Total Deaths in Each State**
```{r}
library(dplyr)
library(ggplot2)

death_totals <- data %>% 
  select(State, Deaths, Cause.Name) %>%
  filter(State != 'United States', Cause.Name != 'All causes') %>%
  group_by(State) %>%
  summarize(Total_Deaths = sum(Deaths, na.rm = TRUE))

# Highlighting California since it has the most deaths
death_totals <- death_totals %>%
  mutate(Color = ifelse(State == "California", "California", "Other"))

TOTAL_DEATHS_BY_STATE <- ggplot(death_totals, aes(x = Total_Deaths, y = reorder(State, Total_Deaths), fill = Color)) +
  geom_col() +
  scale_fill_manual(values = c("California" = "red")) +
  labs(
    x = "Deaths",
    y = "States",
    title = "Total Amount of Deaths in Each State Since 2001"
  ) +
  theme_minimal() +
  theme(legend.position = "none") 

print(TOTAL_DEATHS_BY_STATE)
```

---

## **Leading Cause of Deaths in California **

```{r}
Leading_cause <- data %>%
  filter(State == 'California', Cause.Name != 'All causes') %>%
  group_by(Cause.Name) %>%
  summarize(sum(Deaths)) %>%
  ggplot(aes(x = Cause.Name, y = `sum(Deaths)`)) + geom_col(fill = 'violet', color = 'black') +
  labs(
    title = "Leading Causes of Death in California",
    x = "Cause Name",
    y = "Total Number of Deaths"
  ) +
  theme_minimal()

Leading_cause
```

---

## **How has the number of heart disease deaths changed over time?**

```{r}
# Filtering the heart disease data
heart_data <- subset(data, grepl("Heart disease", Cause.Name, ignore.case = TRUE))

# Number of heart disease deaths each year since 2001
heart_trend <- heart_data %>%
  group_by(Year) %>%
  summarise(Total_Heart_Deaths = sum(Deaths, na.rm = TRUE))

print(heart_trend)

# Number of heart disease deaths each year since 2001
HEART_DISEASE <- data %>% 
  filter(Cause.Name == 'Heart disease', State == 'California') %>%
  group_by(Year) %>%
  summarize(TOTAL = sum(Deaths)) %>%
  
  # Plotting the rate of heart disease deaths over time
  ggplot(aes(x = Year, y = TOTAL)) + 
  geom_line(color = 'lightblue', linewidth = 1.2) + 
  geom_point(color = 'black') +
  labs(
    title = "Total Heart Disease Deaths",
    x = "Year",
    y = "Total number of Heart Disease Deaths"
  ) +
  theme_minimal()

HEART_DISEASE
```

---

## **How has the number of cancer deaths changed over time?**
```{r}
# Filtering the cancer data
cancer_data <- subset(data, grepl("cancer", Cause.Name, ignore.case = TRUE))

# Number of cancer deaths each year since 2001
cancer_trend <- cancer_data %>%
  group_by(Year) %>%
  summarise(Total_Deaths = sum(Deaths))

print(cancer_trend)

# Plotting the rate of cancer deaths over time
library(ggplot2)
ggplot(cancer_trend, aes(x = Year, y = Total_Deaths)) +
  geom_line(color = "aquamarine3", linewidth = 1.2) +
  geom_point(color = "black") +
  labs(title = "Trend of Cancer Deaths Over Time",
       x = "Year",
       y = "Total Cancer Deaths") +
  theme_minimal()
```


